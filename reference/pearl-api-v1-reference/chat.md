# Chat

## Chat

> **The backend needs to establish a connection pool with the gateway instead of having one connection per user.**

<mark style="color:blue;">`WebSocket`</mark>`/ws/v1/chat?app_token=APP_TOKEN (APP_TOKEN Donâ€™t need Bearer prefix)`

**Body**

| Field         | Type   | Optional | Desc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------- | ------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| chat\_type    | number | no       | Private Chat: 1 , Group Chat: 2                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| msg\_id       | string | no       | unique identifier of a message.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ref\_msg\_id  | string | yes      | It means which message the reply represent.                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| timestamp     | number | no       | The timestamp of the message sending, accurate to milliseconds.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| group\_id     | string | yes      | unique identifier of a group.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| sender\_type  | number | no       | BY\_USER: 1 , BY\_AGENT: 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| sender\_id    | string | no       | Who sent this message. The id is the user id                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| receiver\_id  | string | yes      | Who will receive this message. The id is user id                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| resp\_code    | number | no       | <p><mark style="color:red;">0</mark>: Everything is ok </p><p></p><p><mark style="color:red;">10</mark>: The iagent service has received the message, but according to the reply strategy, it is decided not to reply to this message. </p><p></p><p><mark style="color:red;">40</mark>: The msg body is illegal</p><p></p><p><mark style="color:red;">50</mark>: When the iagent service is processing the message, some errors occur. The cause of the error is in the content field.</p> |
| content\_type | number | no       | Text: 1, Image: 2, Voice: 3 , Video: 4                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| content       | string | no       | <p>If ContentType is image or voice, the content format need be</p><p>{"file_ids":["001","002"]}</p>                                                                                                                                                                                                                                                                                                                                                                                        |
